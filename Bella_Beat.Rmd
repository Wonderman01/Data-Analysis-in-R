---
title: "BELLA BEAT CASE STUDY"
author: ' Wonder Unaji'
output:
  html_notebook: default
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---

# INTRODUCTION

Bellabeat is a high-tech company that manufactures health-focused smart products.They offer different smart devices that collect data on activity, sleep, stress, and reproductive health to empower women with knowledge about their own health and habits.

The main focus of this case is to analyze smart devices fitness data and determine how it could help unlock new growth opportunities for Bellabeat. We will focus on one of Bellabeat’s products: Bellabeat app.

The Bellabeat app provides users with health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits. This data can help users better understand their current habits and make healthy decisions. The Bellabeat app connects to their line of smart wellness products.

# 2. ASK 

## 2.1 Business Task 

Identify trends in how consumers use non-Bellabeat smart devices to apply insights into Bellabeat’s marketing strategy.

Stakeholders

* Urška Sršen - Bellabeat cofounder and Chief Creative Officer
* Sando Mur - Bellabeat cofounder and key member of Bellabeat executive team
* Bellabeat Marketing Analytics team

# 3. PREPARE

## 3.1 Dataset used:

The data source used for our case study is FitBit Fitness Tracker Data. This dataset is stored in Kaggle and was made available through Mobius.

## 3.2 ANSWERING THE QUESTION OF BIAS AND CREDIBILITY (ROCCC)

* RELIABILITY

Data collected from only 30 Fitbit Users is too small a sample set hence answering the question of RELIABLITY. We could encounter problems of sampling bias 

* ORIGINAL

Verifying the metadata of our dataset we can confirm it is open-source. By releasing all worldwide rights to the work under copyright law, including any connected and adjacent rights, to the degree permitted by law, the owner has devoted the work to the public domain. Without obtaining consent, you are free to distribute, perform, copy, alter, and even use the work for profit.

* COMPREHENSIVE

Available to us are 18 CSV documents. Each document represents different quantitative data tracked by Fitbit. The data is considered long since each row is one time point per subject, so each subject will have data in multiple rows.Every user has a unique ID and different rows since data is tracked by day and time.

* CURRENT

These datasets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016 and this analysis is being carried out in 2023 approximately 7 years after so the result might not be relevant at the time.

* CITED

As regards CITED all we know about the dataset is it was provided by respondents to a distributed survey via Amazon Mechanical Turk. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. Variation between output represents use of different types of Fitbit trackers and individual tracking behaviors / preferences.




# 4. PROCESS

I decided to use R and Rstudio for the process,cleaning and analysis of this case study because of the amount of data and it's inbuilt reproducible visualisation features to explore the data.

## 4.1 Installing packages and Loading Libraries

```{r}
# Setting up the environment (installing packages)
install.packages("tidyverse")
install.packages("readr")
install.packages("dplyr")
install.packages("tidyr")
install.packages("here")
install.packages("skimr")
install.packages("janitor")
install.packages("ggpubr")
install.packages("ggrepel")
```

```{r packages}
#loading the packages
library(tidyverse)
library(readr)
library(dplyr)
library(tidyr)
library(here)
library(skimr)
library(janitor)
library(lubridate)
library(ggpubr)
library(ggrepel)

```

### 4.2 Importing the Dataset

Of the 18 csv files we already have I decided to work with 7 to streamline my analysis.

```{r}
daily_activity<-read.csv("dailyActivity_merged.csv")
daily_calories<-read.csv("dailyCalories_merged.csv")
daily_intensities<-read.csv("dailyIntensities_merged.csv")
daily_steps<-read.csv("dailySteps_merged.csv")
daily_sleep<-read.csv("sleepDay_merged.csv")
weight_log<-read.csv("weightLogInfo_merged.csv")
minute_METs<-read.csv("minuteMETsNarrow_merged.csv")
hourly_steps<-read.csv("hourlySteps_merged.csv")
```

You could use the view(dataset) function to view any of the dataframes.

## 4.3  Formatting Date and Time Column

I decided to do this early before viewing the datasets to ensure consistency in the different columns using the POSI.xct function.

If you open the datasets in googlesheets or excel you'd notice the inconsistencies in the date columns in the datasets.

```{r}
daily_activity$ActivityDate = as.POSIXct(daily_activity$ActivityDate, format = "%m/%d/%Y",tz = Sys.timezone())
daily_calories$ActivityDay = as.POSIXct(daily_calories$ActivityDay, format = "%m/%d/%Y",tz = Sys.timezone())
daily_intensities$ActivityDay = as.POSIXct(daily_calories$ActivityDay, format = "%m/%d/%Y",tz = Sys.timezone())
daily_steps$ActivityDay = as.POSIXct(daily_calories$ActivityDay, format = "%m/%d/%Y",tz = Sys.timezone())
daily_sleep$SleepDay = as.POSIXct(daily_sleep$SleepDay, format = "%m/%d/%Y",tz = Sys.timezone())
weight_log$Date = as.POSIXct(weight_log$Date, format = "%m/%d/%Y",tz = Sys.timezone())
minute_METs$ActivityMinute = as.POSIXct(minute_METs$ActivityMinute,format = "%m/%d/%Y",tz = Sys.timezone())
hourly_steps$ActivityHour = as.POSIXct(hourly_steps$ActivityHour, format = "%m/%d/%Y %I:%M:%S %p", tz =Sys.timezone())
```

Quick Verification if it has been formatted

```{r}
class(daily_activity$ActivityDate)
class(daily_calories$ActivityDay)
class(daily_intensities$ActivityDay)
class(daily_steps$ActivityDay)
class(daily_sleep$SleepDay)
class(weight_log$Date)
class(minute_METs$ActivityMinute)
class(hourly_steps$ActivityHour)
```

## 4.4 Preview of the Dataframes

The head() function is being used to ensure the dataframes are imported correctly. 

The str() function to show the structure of the dataframes and any interesting features of the datframe.

The colnames() function to retrieve the column names of the dataframes.

```{r}
head(daily_activity)
str(daily_activity)
colnames(daily_activity)
```

```{r}
head(daily_calories)
str(daily_calories)
colnames(daily_calories)
```

```{r}
head(daily_intensities)
str(daily_intensities)
colnames(daily_intensities)
```

```{r}
head(daily_steps)
str(daily_steps)
colnames(daily_steps)
```

```{r}

head(daily_sleep)
str(daily_sleep)
colnames(daily_sleep)
```

```{r}
head(weight_log)
str(weight_log)
colnames(weight_log)
```

```{r}
head(minute_METs)
str(minute_METs)
colnames(minute_METs)
```


```{r}
head(hourly_steps)
str(hourly_steps)
colnames(hourly_steps)
```

## 4.5 Verifying dataframes

You'd notice that in every data frame we selected **(8)** there's a particular column common to all and that's the 'Id' which could be very useful if/when we want to join/merge our dataframes together into one dataframe just like in SQL.

You'd also notice when previewing the dataframes that dataframes such as **daily_calories**, **daily_intensities** and **daily_steps** have columns also in the **daily_activity** merged dataframe implying they've been merged. 

Since they all have a common **Id** we can verify using an SQL package(sqldf) to check whether we could use **daily_activity** dataframe in place of the other three(3) dataframes to avoid making decisions based on assumptions.

To do this the number of observations must match the number of observations for each ID number.

```{r}
# Removing Dataframes
install.packages("sqldf")
```

```{r}
library(sqldf)
```

```{r}
daily_activity_2<-daily_activity %>% 
  select(Id, ActivityDate, Calories)
```

```{r}
head(daily_activity_2)
```

```{r}
sql_check <- sqldf('SELECT * FROM daily_activity_2 INTERSECT SELECT * FROM daily_calories')
```

```{r}
head(sql_check)
```

```{r}
nrow(daily_activity_2)
```

```{r}
nrow(sql_check)
```

```{r}
daily_activity_3 <- daily_activity %>% 
    select(Id, ActivityDate, SedentaryMinutes, LightlyActiveMinutes, FairlyActiveMinutes, VeryActiveMinutes, SedentaryActiveDistance, LightActiveDistance, ModeratelyActiveDistance, VeryActiveDistance)
```

```{r}
head(daily_activity_3)
```

```{r}
sql_check_2 <- sqldf('SELECT * FROM daily_activity_3 INTERSECT SELECT * FROM daily_intensities')
```

```{r}
head(sql_check_2)
```

```{r}
nrow(daily_activity_3)
```

```{r}
nrow(sql_check_2)
```

```{r}
daily_activity_4 <- daily_activity %>% 
  select(Id, ActivityDate, TotalSteps)
```

```{r}
head(daily_activity_4)
```

```{r}
sql_check_3 <- sqldf('SELECT * FROM daily_activity_4 INTERSECT SELECT * FROM daily_steps')
```

```{r}
head(sql_check_3)
```

```{r}
nrow(daily_activity_4)
```

```{r}
nrow(sql_check_3)
```

The outputs of the temporary data frames' head() function match the outputs of the original data frames' head() function.

The outputs of the SQL data frames' head() function match the outputs of the temporary data frames' head() function. The number of observations in each SQL data frame is 940.

In conclusion, **daily_activity** contains the data for the **daily_calories**, **daily_intensities**, and **daily_steps** data frames. Hence, these three data frames will be excluded from the study.

### 4.5.1 Verifying number of participants

```{r}
n_unique(daily_activity$Id)
n_unique(weight_log$Id)
n_unique(daily_sleep$Id)
n_unique(hourly_steps$Id)
```

The  weight log data frame contain a very low number of participants based on the n_unique() outputs. Thus, reliable recommendations and conclusions cannot be made solely from these data frame.Hence we'd drop this dataset. 

###. 4.5.2 Checking for Duplicates

We'd now check for duplicates
```{r}
sum(duplicated(daily_activity))
sum(duplicated(daily_sleep))
sum(duplicated(hourly_steps))
```

###. 4.5.3 Removing Duplicates 

Although we already know that the daily_sleep dataframe contains duplicates, we'd run for all of them

```{r}
#daily_activity
daily_activity<-daily_activity %>% 
  distinct() %>% 
  drop_na()

#daily_sleep
daily_sleep<-daily_sleep %>%
  distinct() %>% 
  drop_na()

#hourly_steps
hourly_steps<-hourly_steps %>% 
  distinct() %>% 
  drop_na()
```

We can verify to ensure the duplicates have been removed

```{r}
sum(duplicated(daily_sleep))
```

## 4.6 Merging Datasets

To merge daily_activity and daily_sleep together, we have to ensure the primary keys to be used such as ID and Date are uniform. Hence a bit of renaming.

```{r}
## renaming ActivityDate in daily_activity
daily_activity <- daily_activity %>% 
  rename(date = ActivityDate) %>% 
  mutate(date)
```

```{r}
## renaming SleepDay in daily_sleep 
daily_sleep <- daily_sleep %>% 
  rename(date = SleepDay) %>% 
  mutate(date)
```

Now merging the datasets

```{r}
daily_activity_sleep<- merge(daily_activity, daily_sleep, by=c ("Id","date"))
glimpse(daily_activity_sleep)
```

# 5. ANALYZE AND SHARE PHASE 

We analyze the trends of FitBit users in order to help us make informed BellaBeat marketing strategies.

We want to ascertain the type of users with the data we have because we don't have any demographic information from our sample. We can categorize people based on their daily number of steps using this information provided by [CDC](https://www.10000steps.org.au/articles/counting-steps/).

* Sedentary is less than 5,000 steps per day 

* Low active is 5,000 to 7,499 steps per day

* Somewhat active is 7,500 to 9,999 steps per day

* Active is more than 10,000 steps per day

* Highly active is more than 12,500 

We calculate the daily average steps by the user

```{r}
daily_average <- daily_activity_sleep %>%
  group_by(Id) %>% 
  summarise(mean_daily_steps = mean(TotalSteps), mean_daily_calories = mean(Calories), mean_daily_sleep = mean(TotalMinutesAsleep)) 
  
head(daily_average)
```

We use the daily_average steps to classify our users

```{r}
user_type <- daily_average %>%
  mutate(user_type = case_when(
    mean_daily_steps < 5000 ~ "sedentary",
    mean_daily_steps >= 5000 & mean_daily_steps < 7499 ~ "lightly active", 
    mean_daily_steps >= 7500 & mean_daily_steps < 9999 ~ "fairly active", 
    mean_daily_steps >= 10000 ~ "very active"
  ))

head(user_type)
```

We will create a data frame with the percentage of each user type now that we have a new column with the user type to better visualise them on a graph.

```{r}
user_type_percent <- user_type %>%
  group_by(user_type) %>%
  summarise(total = n()) %>%
  mutate(totals = sum(total)) %>%
  group_by(user_type) %>%
  summarise(total_percent = total / totals) %>%
  mutate(labels = scales::percent(total_percent))

user_type_percent$user_type <- factor(user_type_percent$user_type , levels = c("very active", "fairly active", "lightly active", "sedentary"))


head(user_type_percent)
```

We can infer from this table that the all the user type wear their smart devices based on user activity.


```{r}
user_type_percent %>%
  ggplot(aes(x="",y=total_percent, fill=user_type)) +
  geom_bar(stat = "identity", width = 1)+
  coord_polar("y", start=0)+
  theme_minimal()+
  theme(axis.title.x= element_blank(),
        axis.title.y = element_blank(),
        panel.border = element_blank(), 
        panel.grid = element_blank(), 
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        plot.title = element_text(hjust = 0.5, size=14, face = "bold")) +
  scale_fill_manual(values = c("#85e085","#e6e600", "#ffd480", "#fd8083")) +
  geom_text(aes(label = labels),
            position = position_stack(vjust = 0.5))+
  labs(title="USER TYPE DISTRIBUTION")
```

## 5.1 Steps and minutes asleep per weekday 

We want to know which days of the week users are the most active and which days of the week users sleep the most. We will also check to see if the users are taking the required number of steps and getting enough sleep.

The weekdays are calculated below depending on our column date. We are also estimating the average number of steps taken and minutes slept per weekday.

```{r}
weekday_steps_sleep <- daily_activity_sleep %>%
  mutate(weekday = weekdays(date))

weekday_steps_sleep$weekday <-ordered(weekday_steps_sleep$weekday, levels=c("Monday", "Tuesday", "Wednesday", "Thursday",
"Friday", "Saturday", "Sunday"))


weekday_steps_sleep <-weekday_steps_sleep%>%
  group_by(weekday) %>%
  summarize (daily_steps = mean(TotalSteps), daily_sleep = mean(TotalMinutesAsleep))

head(weekday_steps_sleep)
```

```{r}

ggplot(weekday_steps_sleep)+
  geom_col(aes(weekday, daily_steps), fill= "darkblue", width = 0.8)+
  geom_hline(yintercept = 7500, colour ="red")+
  labs(title = "DAILY STEP PER WEEKDAY", x= " ", y = " ")+
  theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle = 45,vjust = 0.5, hjust = 1) )
```

From this graph we can infer that Fitbit Users walk an average of 7500 steps daily asides sundays which according to CDC's reccommendation falls under "somewhat active".

Researchers found that, in a study published on March 24, 2020, in the Journal of the American Medical Association, "taking 8,000 steps per day was associated with a 51% lower risk for all-cause mortality (or death from all causes), compared with taking 4,000 steps per day, a number considered to be low for adults." Compared to 4,000 steps a day, walking 12,000 steps was linked to a 65% decreased risk.

For most adults, the CDC advises taking 8,000 steps a day, with a goal of 10,000 steps. **Although we had 7500 it’s averagely okay but could be much better.**

```{r}
ggplot(weekday_steps_sleep)+
  geom_col(aes(weekday, daily_sleep), fill= "lightblue",width = 0.8)+
  geom_hline(yintercept = 400, colour ="red")+
  labs(title = "DAILY SLEEP PER WEEKDAY", x= " ", y = " ")+
  theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle = 45,vjust = 0.5, hjust = 1) )
```

From this graph we can infer that Fitbit users sleep and average of 400 minutes daily with sunday having the highest time spent sleeping owing to possibly less activity(weekend).

However 400 minutes which is equivalent to 6.67 hours daily is below the reccommended sleep by CDC for adults which is 8 hours.

## 5.2  Most/least active days

We want to ascertain the the time users were more/least active during the day using the hourly steps dataset

```{r}
hourly_steps <- hourly_steps %>%
  rename(date_time = Activ)

head(hourly_steps)
```

```{r}
hourly_steps %>%
  group_by(time) %>%
  summarize(average_steps = mean(StepTotal)) %>%
  ggplot() +
  geom_col(mapping = aes(x=time, y = average_steps, fill = average_steps)) + 
  labs(title = "Hourly steps throughout the day", x="", y="") + 
  theme(plot.title = element_text(hjust = 0.5))+
  scale_fill_gradient(low = "green", high = "red")+
  theme(axis.text.x = element_text(angle = 90))
```

## 5.3 Correlations among different Variables

We would now check for correlations and possibly causations between :

daily_steps and calories and 

daily_steps and daily_sleep

sendentary minutes and Minutes asleep

```{r}
# daily_steps and Calories
ggplot(daily_activity_sleep, aes(x = TotalSteps, y =Calories))+
  geom_jitter()+
  geom_smooth(colour = "blue")+
  labs(title = "DAILY STEPS vs  DAILY CALORIES")+
  theme(plot.title = element_text(hjust = 0.5),
        plot.background = element_rect())

# daily steps and minutes asleep
ggplot(daily_activity_sleep, aes(x = TotalSteps, y =TotalMinutesAsleep))+
  geom_jitter()+
  geom_smooth(colour = "blue")+
  labs(title = "DAILY STEPS vs MINUTES ASLEEP")+
  theme(plot.title = element_text(hjust = 0.5),
        plot.background = element_rect())
  
# sendentary minutes and minutes asleep
ggplot(daily_activity_sleep, aes (x=TotalMinutesAsleep, y =SedentaryMinutes))+
  geom_jitter()+
  geom_smooth(colour = "blue")+
  labs( title = " MINUTES ASLEEP VS SENDENTARY MINUTES")+
  theme(plot.title = element_text(hjust = 0.5),
        plot.background = element_rect())
  
```

From the first plot we can infer a positive relationship between Daily steps and Daily Calories meaning the more steps the users took in the day the more calories they burnt.

From the second plot we can infer no relationship exists between Daily steps and Minutes asleep .

From the third plot we can infer a negative relationship between Sedentary minutes and Sleep time. Howevever, **if Bellabeat users want to improve their sleep, Bellabeat app can recommend reducing sedentary time.**

## 5.4 Use of Smart Devices

We will calculate the number of users who use their smart device on a daily basis, categorizing our sample into three groups based on the date interval of 31 days:

 * High use - users who use their device between 21 and 31 days.
 * Moderate use - users who use their device between 10 and 20 days.
 * Low use - users who use their device between 1 and 10 days.
 
Creating a new dataframe to house this information.

```{r}
daily_use <- daily_activity_sleep %>% 
  group_by(Id) %>%
  summarize(days_used =sum(n())) %>%
  mutate(usage = case_when(
    days_used >= 1 & days_used <= 10 ~ "Low use",
    days_used >= 11 & days_used <= 20 ~ "Moderate use", 
    days_used >= 21 & days_used <= 31 ~ "High use", 
      )
    )
head(daily_use)
  
```

To better visualize the results on the graph, we are going to create a percentage data frame. Our utilization levels are also being ordered.

```{r}
daily_use_percent <- daily_use %>%
  group_by(usage) %>%
  summarise(total = n()) %>%
  mutate(totals = sum(total)) %>%
  group_by(usage) %>%
  summarise(total_percent = total / totals) %>%
  mutate(labels = scales::percent(total_percent))

daily_use_percent$usage <- factor(daily_use_percent$usage, levels = c("High use", "Moderate use", "Low use"))

 
  
head(daily_use_percent)
```


```{r}
daily_use_percent %>%
  ggplot(aes(x="",y=total_percent, fill=usage)) +
  geom_bar(stat = "identity", width = 1)+
  coord_polar("y", start=0)+
  theme_minimal()+
  theme(axis.title.x= element_blank(),
        axis.title.y = element_blank(),
        panel.border = element_blank(), 
        panel.grid = element_blank(), 
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        plot.title = element_text(hjust = 0.5, size=14, face = "bold")) +
  geom_text(aes(label = labels),
            position = position_stack(vjust = 0.5))+
  scale_fill_manual(values = c("#004d99","#3399ff","#cce6ff"),
                    labels = c("High use - 21 to 31 days",
                                 "Moderate use - 11 to 20 days",
                                 "Low use - 1 to 10 days"))+
 
  labs(title="DAILY USE OF SMART DEVICE")  
```

From this visualization we can infer that 

 * 50% of the users use their smart devices highly(21-31 days)
 
 * 12% of the users use their smart devices moderately(11-20 days)
 
 * 38% of the users use their smart devices rarely/lowly(1-10 days)
 

# 6. ACT (CONCLCUSION)

In summary, Bellabeat has been able to provide women with information about their own health and behaviors by gathering data on activity, sleep, stress, and reproductive health. Bellabeat was established in 2013 and has since expanded significantly, positioning itself as a tech-driven health firm catering to women.

However having done an in-depth analysis accompanied by visualisations of some particular datasets. Here are a few recommendations to improve BellaBeat's app and in turn inform BellaBeat marketing strategy.

 **Daily notification on steps and posts on BellaBeat app**

With the exception of Sundays, users fall into 4 categories, and we found that on average, they walk over 7,500 steps every day. We can motivate users to complete the CDC's suggested 8,000 steps by setting alarms to notify them when they haven't completed the required number of steps and by posting messages on our app outlining the advantages of accomplishing that goal. According to the CDC, the death risk decreases with increasing step count. Additionally, we observed a favorable relationship between calories and steps.

 **Socialisation Features**

With data obtained from hourly and daily metrics. Users can be engaged further by receiving prompts on how they are doing at the point of the day or week when compared to others in their age/location/gender group.

  * For Activity Comparison with Age Group:

"Good job! You've taken as many steps as those in your age group!"

"You're keeping up with your age group's activity levels. Keep it going!"

  * For Activity Comparison with Past Performance:

"Keep it up! You're almost as active as you were this time last week!"

"You're making great progress. Stay consistent!"

  * For Activity Comparison with Weekly Percentile:

"You're not alone in this! You're in the 50th percentile of most active minutes this week!"

"You're among the most active users this week. Keep pushing!"

  * For Recovery:

"Rest up! A good recovery is just as important as a good run."

"Your body needs rest too. Take a break and recover."

**Sleep Notification and techniques**

Our findings indicate that users get less than 8 hours of sleep each day. Users might schedule a specific time to go to bed and get a notification a few minutes beforehand to get ready for bed. Provide customers with more sleep-related materials, such as breathing exercises, calming music podcasts, and sleep strategies.

**Reward system**

We may develop a sort of game on our app for a little period of time because we know that not everyone is driven by notifications. The goal of the game would be to advance through several stages according to how many steps you take each day. In order to advance to the next level, you must continue your current level of activity for a while—perhaps a month. You would receive a set number of stars for completing each level, which you could then exchange for merchandise or discounts on other Bellabeat products.





  **Special Thanks**

The following authors, who have finished their own capstone work, deserve all credit. I was able to get direction and clarity on how to approach my first attempt at R programming thanks to their writings. I strongly advise all students attempting this capstone to review their work:

1. [https://www.kaggle.com/code/macarenalacasa/capstone-case-study-bellabeat/notebook](https://www.kaggle.com/code/macarenalacasa/capstone-case-study-bellabeat/notebook)

2. [https://www.kaggle.com/code/zulkhaireesulaiman/bellabeat-capstone-project-in-r#-6.-Discussions](https://www.kaggle.com/code/zulkhaireesulaiman/bellabeat-capstone-project-in-r#-6.-Discussions--)
